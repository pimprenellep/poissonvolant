function initializeDownloadLinkHover(){var downloadSizes=$('.download_size');var applyEffectToPrevSiblings=false;if(typeof enableRedownloadForPremiumPhotos!=='undefined'&&enableRedownloadForPremiumPhotos===true){applyEffectToPrevSiblings=true;}
downloadSizes.hover(function(){var target=$(this);var hoverMessageSpan=target.find('.download-hover-message');var creditMessageSpan=target.find('.download-hover-credits');if(hoverMessageSpan.length>0){target.addClass('download-full-opacity');creditMessageSpan.hide();hoverMessageSpan.show();}
if(applyEffectToPrevSiblings===true){var previousSiblings=target.prevAll('a:not(.not_available)');previousSiblings.addClass('download_size_selected');}},function(){var target=$(this);var hoverMessageSpan=target.find('.download-hover-message');var creditMessageSpan=target.find('.download-hover-credits');if(hoverMessageSpan.length>0){target.removeClass('download-full-opacity');hoverMessageSpan.hide();creditMessageSpan.show();}
if(applyEffectToPrevSiblings===true){var previousSiblings=target.prevAll('a:not(.not_available)');previousSiblings.removeClass('download_size_selected');}});}
function updateLargerDownloads(domTarget,downloadedSize){var siblingsAfter=domTarget.nextAll('a:not(.not_available)');var downloadedCreditsUsed=domTarget.attr('originalCreditsNeeded');siblingsAfter.each(function(i,dom){var targetSibling=$(dom);var sizeRight=targetSibling.find('.size > .size-right');var creditsNeeded=targetSibling.attr('credits');var originalCreditsNeeded=targetSibling.attr('originalCreditsNeeded');var newCreditsNeeded=originalCreditsNeeded- downloadedCreditsUsed;if(newCreditsNeeded>=0&&!targetSibling.hasClass('download_size_redownload')&&creditsNeeded>newCreditsNeeded){var newCreditCostText='';if(newCreditsNeeded===0){newCreditCostText=globalDownloadAgainText.replace('<placeholder />',originalCreditsNeeded);}
else{newCreditCostText='Premium -';newCreditCostText+=' <span class="credits-adjusted">'+ originalCreditsNeeded+'</span>';newCreditCostText+=' '+ newCreditsNeeded;newCreditCostText+=' Credits';}
sizeRight.html(newCreditCostText);targetSibling.attr('credits',newCreditsNeeded);}});}
function updateSmallerDownloads(domTarget,downloadedSize){if(jQuery.inArray(downloadedSize,['M','L','XL','XXL','3XL'])!==-1){var smallerSizes=[];if(downloadedSize==='M'){smallerSizes=['S'];}
else if(downloadedSize==='L'){smallerSizes=['S','M'];}
else if(downloadedSize==='XL'){smallerSizes=['S','M','L'];}
else if(downloadedSize==='XXL'){smallerSizes=['S','M','L','XL'];}
else if(downloadedSize==='3XL'){smallerSizes=['S','M','L','XL','XXL'];}
if(smallerSizes.length>0){var parent=domTarget.parent();var children=parent.find('a');if(children.length>0){for(var i=0;i<children.length;i++){var current=$(children[i]);var imageSize=current.attr('image-size');var sizeRight=current.find('.size > .size-right');var canRedownloadAgain=sizeRight.attr('can-redownload-again');if(smallerSizes.indexOf(imageSize)!==-1&&typeof canRedownloadAgain==='undefined'){var originalCreditsNeeded=current.attr('originalCreditsNeeded');sizeRight.attr('can-redownload-again','1');sizeRight.html(globalDownloadAgainText.replace('<placeholder />',originalCreditsNeeded));current.addClass('download_size_redownload');current.removeClass('download_size_selected');}}}}}}
function executeSingleDownload(domTarget){var url=domTarget.attr('url');var sizeToDownload=domTarget.attr('image-size');if(url=="javascript:;"){return;}
var extraParams="";if($("#do-not-show-again").is(":checked")){$("#no-free-credits-download-warning-submit").prop("disabled",true);$("#do-not-show-again").prop("disabled",true);$("#no-free-credits-download-warning-no-button").prop("disabled",true);if($("#do-not-show-again").val()=='free'){window.showFreeDepleted=0;}else if($("#do-not-show-again").val()=='premium'){window.showCreditsWarning=0;}
extraParams+="&disableWarning="+ $("#do-not-show-again").val();close_overlay();$("#no-free-credits-download-warning-submit").prop("disabled",false);$("#do-not-show-again").prop("disabled",false);$("#no-free-credits-download-warning-no-button").prop("disabled",false);}else{close_overlay();}
url+=extraParams;updateDownloadQuota();window.location=url;var sizeTextElement=domTarget.find('.size-right');if(typeof enableRedownloadForPremiumPhotos!=='undefined'&&enableRedownloadForPremiumPhotos===true){var originalCreditsNeeded=domTarget.attr('originalCreditsNeeded');sizeTextElement.attr('can-redownload-again','1');sizeTextElement.html(globalDownloadAgainText.replace('<placeholder />',originalCreditsNeeded));domTarget.addClass('download_size_redownload');updateSmallerDownloads(domTarget,sizeToDownload);if(enableCreditAdjustments===true){updateLargerDownloads(domTarget,sizeToDownload);}}
else{sizeTextElement.attr('downloaded-today','1');sizeTextElement.html("Downloaded Today");}}
function doDownload(target){var domTarget=$(target);$("#do-not-show-again").attr('checked',false);if(domTarget.hasClass('non_click')){return;}
if(domTarget.hasClass('not_available')){window.location='/premiumaccess';return;}
var credits=parseInt(domTarget.attr('credits'));var imageType=domTarget.attr('imagetype');var fileSizeInKb=parseInt(domTarget.attr('filesizeinkb'));var fileSizeInMb=Math.round((fileSizeInKb/1024)*10)/ 10;
var sizeToDownload=domTarget.attr('image-size');var logCreditRequirement=["S","M"];var seamlessAplhaMasked=["alphamasked","seamless"];var freeCreditsImageType=["content-upload-free"];var creditsText=domTarget.find('.size-right');var downloadedTodayAttr=creditsText.attr('downloaded-today');var downloadToday=(typeof downloadedTodayAttr!==typeof undefined&&downloadedTodayAttr!==false)?true:false;var canRedownloadAgainAttr=creditsText.attr('can-redownload-again');var canRedownloadAgain=(typeof canRedownloadAgainAttr!==typeof undefined&&canRedownloadAgainAttr!==false)?true:false;if(downloadToday||canRedownloadAgain){executeSingleDownload(domTarget);}else if(imageType=='free-sample'){executeSingleDownload(domTarget);}else{if(window.isPremiumSubscription&&credits>=30&&window.premiumCredits>=credits){downloadWarning(fileSizeInMb,credits,function(){window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);},false);}else{if(((logCreditRequirement.indexOf(sizeToDownload)==-1)&&(window.premiumCredits==0||window.premiumCredits<credits)&&(freeCreditsImageType.indexOf(imageType)==-1))||(logCreditRequirement.indexOf(sizeToDownload)>-1&&(seamlessAplhaMasked.indexOf(imageType)==-1)&&window.premiumCredits<credits&&window.freeDownloadCredits<credits)){$(".no_credits_warning_overlay").fadeIn(350);return false;}
if(sizeToDownload=='M'&&(seamlessAplhaMasked.indexOf(imageType)>-1)){if(window.premiumCredits<credits){$(".no_credits_warning_overlay").fadeIn(350);return false;}else{if(window.showCreditsWarning){confirmPremiumCreditsToUse('This file can only be downloaded with Premium Credits.<br>'+ credits+' Premium Credits will be used.',function(){window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);},'premium');}else{window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);}}}else if(window.freeDownloadCredits==0&&window.premiumCredits>=credits){if((logCreditRequirement.indexOf(sizeToDownload)>-1)||(freeCreditsImageType.indexOf(imageType)>-1)){if(window.showFreeDepleted){confirmPremiumCreditsToUse('You have used up all your free credits for today. Downloading this file will use up some of your Premium credits.',function(){window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);},'free');}else{window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);}}else{if(window.showCreditsWarning){confirmPremiumCreditsToUse('This file can only be downloaded with Premium Credits.<br>'+ credits+' Premium Credits will be used.',function(){window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);},'premium');}else{window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);}}}else if(window.freeDownloadCredits>0&&((logCreditRequirement.indexOf(sizeToDownload)>-1)||(freeCreditsImageType.indexOf(imageType)>-1))){if(window.freeDownloadCredits>=credits){window.freeDownloadCredits=window.freeDownloadCredits- credits;executeSingleDownload(domTarget);}else{if(window.showCreditsWarning){confirmPremiumCreditsToUse('You do not have enough Free Credits to download this file.<br>'+(credits-window.freeDownloadCredits)+' Premium credits will be used',function(){window.premiumCredits=window.premiumCredits-(credits-window.freeDownloadCredits);window.freeDownloadCredits=window.freeDownloadCredits-(credits-(credits-window.freeDownloadCredits));executeSingleDownload(domTarget);},'free');}else{window.premiumCredits=window.premiumCredits-(credits-window.freeDownloadCredits);window.freeDownloadCredits=window.freeDownloadCredits-(credits-(credits-window.freeDownloadCredits));executeSingleDownload(domTarget);}}}else if((logCreditRequirement.indexOf(sizeToDownload))<0&&(freeCreditsImageType.indexOf(imageType)<0)){if(window.showCreditsWarning){confirmPremiumCreditsToUse('This file can only be downloaded with Premium Credits.<br>'+ credits+' Premium Credits will be used.',function(){window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);},'premium');}else{window.premiumCredits=window.premiumCredits- credits;executeSingleDownload(domTarget);}}}}
return false;}
function confirmPremiumCreditsToUse(message,downloadCallback,creditType){$(".warning_text").html(message);$("#do-not-show-again").val(creditType);$(".no_free_credits_warning_overlay").fadeIn(350);$('#no-free-credits-download-warning-submit').bind("click",function(){if(downloadCallback){downloadCallback();}
$(this).unbind("click");});}
function close_no_free_credits_overlay(){$("#no-free-credits-download-warning-submit").unbind("click");$(".no_free_credits_warning_overlay").fadeOut(350);}
function close_no_credits_overlay(){$(".no_credits_warning_overlay").fadeOut(350);}
function executeHideDownloadWholeSet(){$('.download_drop_down').hide();download_drop=0;}
function cancelHideDownloadWholeSet(){if(hideDownloadWholeSetTimeout){clearTimeout(hideDownloadWholeSetTimeout);hideDownloadWholeSetTimeout=null;}}
function hideDownloadWholeSet(){cancelHideDownloadWholeSet();hideDownloadWholeSetTimeout=setTimeout(executeHideDownloadWholeSet,500);}
function showLoaderAndUpdateQuota(){$('.download-loader').show();setTimeout(function(){$('.download-loader').hide();updateDownloadQuota();},300);}
function doDownloadWholeSet(target){var targetParent=$(target).parent();var domTarget=$(target);var credits=parseInt(domTarget.attr('credits'));if(targetParent.hasClass('size-cannot-be-downloaded')){return;}
if(credits>=30){downloadWarning(0,credits,function(){executeHideDownloadWholeSet();window.location=domTarget.attr('url');showLoaderAndUpdateQuota();close_overlay();},true);}else{executeHideDownloadWholeSet();window.location=domTarget.attr('url');showLoaderAndUpdateQuota()}
return false;}
function downloadWarning(size,credits,downloadCallback,isWholeset){if(isWholeset==true){$("#download_warning_title").html('Download Archive');$("#download-warning-submit").val('Download Archive');}else{$("#download_warning_title").html('Download file');$("#download-warning-submit").val('Download');}
$(".download_warning_overlay").fadeIn(350);$("#download_warning_size").text(credits);$('#download-warning-submit').bind("click",function(){if(downloadCallback){downloadCallback();}
$(this).unbind("click");});}